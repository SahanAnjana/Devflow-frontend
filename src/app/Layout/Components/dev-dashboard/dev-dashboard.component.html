<div class="dashboard-container">
  <!-- Header Section -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <h1 class="welcome-title">
        Welcome back, {{ currentUser?.sub || "User" }}!
      </h1>
      <p class="welcome-subtitle">
        Here's your comprehensive overview of DevFlow today.
      </p>
    </div>
    <button class="new-project-btn" (click)="startNewProject()">
      <span class="btn-icon">+</span>
      Start New Project
    </button>
  </div>

  <!-- Main Content Grid -->
  <div class="dashboard-grid">
    <!-- KPI Cards Section -->
    <div class="kpi-section">
      <h2 class="section-title">Key Performance Indicators</h2>
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-header">
            <div class="kpi-icon total-projects">📊</div>
            <div class="kpi-details">
              <span class="kpi-label">Total Projects</span>
              <span
                class="kpi-value"
                *ngIf="!isLoadingProjects && !projectsError"
                >{{ kpiData.totalProjects }}</span
              >
              <div class="loading-spinner" *ngIf="isLoadingProjects">
                <span class="spinner"></span>
              </div>
              <span class="error-state" *ngIf="projectsError"
                >Error loading</span
              >
            </div>
          </div>
          <div class="kpi-trend positive">
            <span class="trend-icon">↗</span>
            <span class="trend-text">Live data from API</span>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-header">
            <div class="kpi-icon open-issues">🔧</div>
            <div class="kpi-details">
              <span class="kpi-label">Open Issues</span>
              <span
                class="kpi-value"
                *ngIf="!isLoadingIssues && !issuesError"
                >{{ kpiData.openIssues }}</span
              >
              <div class="loading-spinner" *ngIf="isLoadingIssues">
                <span class="spinner"></span>
              </div>
              <span class="error-state" *ngIf="issuesError">Error loading</span>
            </div>
          </div>
          <div class="kpi-trend negative">
            <span class="trend-icon">📊</span>
            <span class="trend-text">Live data from API</span>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-header">
            <div class="kpi-icon revenue">💰</div>
            <div class="kpi-details">
              <span class="kpi-label">Main Budget</span>
              <span class="kpi-value" *ngIf="!isLoadingBudgets && !budgetsError"
                >${{ kpiData.revenue }}</span
              >
              <div class="loading-spinner" *ngIf="isLoadingBudgets">
                <span class="spinner"></span>
              </div>
              <span class="error-state" *ngIf="budgetsError"
                >Error loading</span
              >
            </div>
          </div>
          <div class="kpi-trend positive">
            <span class="trend-icon">💰</span>
            <span class="trend-text">From top 5 budgets</span>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-header">
            <div class="kpi-icon utilization">🏢</div>
            <div class="kpi-details">
              <span class="kpi-label">Total Companies</span>
              <span
                class="kpi-value"
                *ngIf="!isLoadingCompanies && !companiesError"
                >{{ kpiData.totalCompanies }}</span
              >
              <div class="loading-spinner" *ngIf="isLoadingCompanies">
                <span class="spinner"></span>
              </div>
              <span class="error-state" *ngIf="companiesError"
                >Error loading</span
              >
            </div>
          </div>
          <div class="kpi-trend positive">
            <span class="trend-icon">🏢</span>
            <span class="trend-text">Live data from CRM</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Access Section -->
    <div class="quick-access-section">
      <h2 class="section-title">Quick Access</h2>
      <div class="quick-access-grid">
        <div
          class="quick-access-card"
          (click)="navigateToDepartment('project')"
        >
          <div class="quick-icon projects">📋</div>
          <div class="quick-content">
            <h3 class="quick-title">Projects</h3>
            <p class="quick-description">
              Manage all project timelines and tasks.
            </p>
          </div>
        </div>

        <div class="quick-access-card" (click)="navigateToDepartment('crm')">
          <div class="quick-icon crm">🤝</div>
          <div class="quick-content">
            <h3 class="quick-title">CRM</h3>
            <p class="quick-description">
              Track customer interactions and deals.
            </p>
          </div>
        </div>

        <div
          class="quick-access-card"
          (click)="navigateToDepartment('finance')"
        >
          <div class="quick-icon finance">💼</div>
          <div class="quick-content">
            <h3 class="quick-title">Finance</h3>
            <p class="quick-description">
              Overview of accounts, expenses, and invoices.
            </p>
          </div>
        </div>

        <div class="quick-access-card" (click)="navigateToDepartment('hr')">
          <div class="quick-icon hr">👨‍💼</div>
          <div class="quick-content">
            <h3 class="quick-title">HR</h3>
            <p class="quick-description">
              Employee management and recruitment.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts Section -->
  <div class="charts-section">
    <div class="chart-container">
      <div class="chart-card">
        <h3 class="chart-title">Revenue Trends</h3>
        <div class="chart-placeholder">
          <div class="chart-line"></div>
          <div class="chart-data">
            <span class="chart-point" style="left: 10%"></span>
            <span class="chart-point" style="left: 25%"></span>
            <span class="chart-point" style="left: 40%"></span>
            <span class="chart-point" style="left: 60%"></span>
            <span class="chart-point" style="left: 80%"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="chart-container">
      <div class="chart-card">
        <h3 class="chart-title">Project Status Overview</h3>
        <div class="project-status">
          <div class="status-item">
            <div class="status-dot completed"></div>
            <span>Completed (45%)</span>
          </div>
          <div class="status-item">
            <div class="status-dot in-progress"></div>
            <span>In Progress (35%)</span>
          </div>
          <div class="status-item">
            <div class="status-dot pending"></div>
            <span>Pending (20%)</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
